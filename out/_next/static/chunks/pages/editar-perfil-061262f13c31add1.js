(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[733],{6842:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/editar-perfil",function(){return n(2002)}])},1089:function(e,t,n){"use strict";n.d(t,{t:function(){return u}});var a=n(5893),r=n(7294),l=n(1163),o=n(6816);function u(e,t){return function(n){let u=(0,l.useRouter)(),[i,s]=(0,r.useState)(null),[c,d]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(async()=>{var e;let{data:{user:n},error:a}=await o.O.auth.getUser();if(a||!n){u.push("/login");return}let r=null===(e=n.user_metadata)||void 0===e?void 0:e.role;if(!r||!t.includes(r)){u.push("/unauthorized");return}s(r),d(!1)})()},[u,t]),c)?(0,a.jsx)("p",{children:"Carregando..."}):i?(0,a.jsx)(e,{...n,role:i}):null}}},2761:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(1134).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1664:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(1134).Z)("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},2002:function(e,t,n){"use strict";n.r(t);var a=n(5893),r=n(7294),l=n(9332),o=n(6816),u=n(1089),i=n(2761),s=n(1664);t.default=(0,u.t)(function(){let e=(0,l.useRouter)(),[t,n]=(0,r.useState)(null),[u,c]=(0,r.useState)(""),[d,f]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{let{data:{user:e},error:t}=await o.O.auth.getUser();if(t||!e){c("Usu\xe1rio n\xe3o autenticado");return}let{data:a}=await o.O.from("alunos").select("*").eq("user_id",e.id).maybeSingle();if(a){n({tipo:"aluno",nome:a.nome,email:a.email,cpf:a.cpf,endereco:a.endereco,telefone:a.telefone,matricula:a.matricula,curso:a.curso,serie:a.serie});return}let{data:r}=await o.O.from("funcionarios").select("*").eq("user_id",e.id).maybeSingle();if(r){n({tipo:"funcionario",nome:r.nome,email:r.email,cpf:r.cpf,endereco:r.endereco,telefone:r.telefone,funcao:r.funcao});return}c("Usu\xe1rio n\xe3o encontrado")})()},[]);let m=async n=>{n.preventDefault(),c(""),f("");let{data:{user:a}}=await o.O.auth.getUser();if(!a||!t)return;let r="aluno"===t.tipo?"alunos":"funcionarios",{error:l}=await o.O.from(r).update({nome:t.nome,email:t.email,cpf:t.cpf,endereco:t.endereco,telefone:t.telefone,..."aluno"===t.tipo&&{matricula:t.matricula,curso:t.curso,serie:t.serie},..."funcionario"===t.tipo&&{funcao:t.funcao}}).eq("user_id",a.id);l?c("Erro ao atualizar perfil: "+l.message):(f("Perfil atualizado com sucesso!"),setTimeout(()=>e.push("/perfil"),2e3))};return t||u?(0,a.jsxs)("div",{className:"relative flex flex-col items-center justify-center min-h-screen bg-[#006400] px-4 sm:px-8",children:[(0,a.jsx)("button",{onClick:()=>e.push("/perfil"),className:"absolute top-4 right-4 bg-white text-[#006400] rounded-full p-2 shadow-md hover:bg-emerald-100 transition",children:(0,a.jsx)(i.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{className:"relative z-10 bg-[#2e8b57] rounded-[30px] p-8 sm:p-12 max-w-xl w-full shadow-2xl",children:[(0,a.jsxs)("h1",{className:"text-3xl sm:text-4xl font-bold text-white text-center mb-8 flex items-center justify-center gap-3 drop-shadow",children:[(0,a.jsx)(s.Z,{className:"w-8 h-8"})," Editar Perfil"]}),u&&(0,a.jsx)("p",{className:"text-red-400 text-center mb-4",children:u}),d&&(0,a.jsx)("p",{className:"text-green-400 text-center mb-4",children:d}),t&&(0,a.jsxs)("form",{onSubmit:m,className:"space-y-5",children:[[{label:"Nome",key:"nome"},{label:"Email",key:"email"},{label:"CPF",key:"cpf"},{label:"Endere\xe7o",key:"endereco"},{label:"Telefone",key:"telefone"}].map(e=>{let{label:r,key:l}=e;return(0,a.jsx)("input",{className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",placeholder:r,value:t[l],onChange:e=>n({...t,[l]:e.target.value})},l)}),"aluno"===t.tipo&&(0,a.jsx)(a.Fragment,{children:[{label:"Matr\xedcula",key:"matricula"},{label:"Curso",key:"curso"},{label:"S\xe9rie",key:"serie"}].map(e=>{let{label:r,key:l}=e;return(0,a.jsx)("input",{className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",placeholder:r,value:t[l],onChange:e=>n({...t,[l]:e.target.value})},l)})}),"funcionario"===t.tipo&&(0,a.jsx)("input",{className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",placeholder:"Fun\xe7\xe3o",value:t.funcao,onChange:e=>n({...t,funcao:e.target.value})}),(0,a.jsx)("button",{type:"submit",className:"w-full bg-white text-[#006400] font-bold py-4 rounded-full hover:bg-emerald-100 transition shadow-lg",children:"Salvar altera\xe7\xf5es"})]})]})]}):(0,a.jsx)("p",{className:"p-4 text-white",children:"Carregando..."})},["aluno","funcionario","funcionario_administrador"])}},function(e){e.O(0,[332,888,774,179],function(){return e(e.s=6842)}),_N_E=e.O()}]);