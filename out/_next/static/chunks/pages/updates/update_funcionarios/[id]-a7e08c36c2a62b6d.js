(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[916],{2186:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/updates/update_funcionarios/[id]",function(){return t(9724)}])},1089:function(e,n,t){"use strict";t.d(n,{t:function(){return a}});var o=t(5893),r=t(7294),i=t(1163),s=t(6816);function a(e,n){return function(t){let a=(0,i.useRouter)(),[u,l]=(0,r.useState)(null),[c,f]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(async()=>{var e;let{data:{user:t},error:o}=await s.O.auth.getUser();if(o||!t){a.push("/login");return}let r=null===(e=t.user_metadata)||void 0===e?void 0:e.role;if(!r||!n.includes(r)){a.push("/unauthorized");return}l(r),f(!1)})()},[a,n]),c)?(0,o.jsx)("p",{children:"Carregando..."}):u?(0,o.jsx)(e,{...t,role:u}):null}}},1664:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});let o=(0,t(1134).Z)("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},9724:function(e,n,t){"use strict";t.r(n);var o=t(5893),r=t(1089),i=t(7294),s=t(9332),a=t(6816),u=t(2034),l=t.n(u),c=t(2761),f=t(1664);n.default=(0,r.t)(function(){let{id:e}=(0,s.useParams)(),n=(0,s.useRouter)(),[t,r]=(0,i.useState)({nome:"",cpf:"",funcao:"",endereco:"",email:"",telefone:""}),[u,d]=(0,i.useState)(""),[m,p]=(0,i.useState)("");function h(e){return e.trim().toLowerCase().replace(/\s+/g," ")}function x(e){return e.replace(/\D/g,"")}function g(e){r({...t,[e.target.name]:e.target.value})}(0,i.useEffect)(()=>{(async()=>{let{data:n,error:t}=await a.O.from("funcionarios").select("*").eq("id",e).single();if(t){d("Erro ao buscar funcion\xe1rio.");return}n&&r({nome:n.nome,cpf:n.cpf,funcao:n.funcao,endereco:n.endereco,email:n.email,telefone:n.telefone})})()},[e]);let w=async o=>{o.preventDefault(),d(""),p("");let r=h(t.nome),i=x(t.cpf).trim(),s=x(t.telefone).trim();if(!/^\d{10,11}$/.test(s)){d("O telefone deve conter 10 ou 11 d\xedgitos num\xe9ricos.");return}let{data:u,error:l}=await a.O.from("funcionarios").select("id, nome, cpf").neq("id",e);if(l){d("Erro ao verificar duplicidade do nome.");return}if(null==u?void 0:u.some(e=>h(e.nome)===r)){d("J\xe1 existe um funcion\xe1rio com esse nome.");return}if(null==u?void 0:u.some(e=>x(e.cpf)===i)){d("J\xe1 existe um funcion\xe1rio com esse CPF.");return}let{error:c}=await a.O.from("funcionarios").update({nome:t.nome.trim(),cpf:i,endereco:t.endereco.trim(),email:t.email.trim(),telefone:s,funcao:t.funcao.trim()}).eq("id",e);c?d("Erro ao atualizar funcion\xe1rio: "+c.message):(p("Funcion\xe1rio atualizado com sucesso!"),setTimeout(()=>n.push("/pesq_funcionarios"),2e3))};return(0,o.jsxs)("div",{className:"relative flex flex-col items-center justify-center min-h-screen bg-[#006400] px-4 sm:px-8",children:[(0,o.jsx)("button",{onClick:()=>n.push("/pesq_funcionarios"),className:"absolute top-4 right-4 bg-white text-[#006400] rounded-full p-2 shadow-md hover:bg-emerald-100 transition",children:(0,o.jsx)(c.Z,{className:"w-6 h-6"})}),(0,o.jsxs)("div",{className:"relative z-10 bg-[#2e8b57] rounded-[30px] p-8 sm:p-12 max-w-xl w-full shadow-2xl",children:[(0,o.jsxs)("h1",{className:"text-3xl sm:text-4xl font-bold text-white text-center mb-8 flex items-center justify-center gap-3 drop-shadow",children:[(0,o.jsx)(f.Z,{className:"w-8 h-8"})," Editar Funcion\xe1rio"]}),u&&(0,o.jsx)("p",{className:"text-red-400 text-center mb-4",children:u}),m&&(0,o.jsx)("p",{className:"text-green-400 text-center mb-4",children:m}),(0,o.jsxs)("form",{onSubmit:w,className:"space-y-5",children:[["nome","funcao","endereco","email"].map(e=>(0,o.jsx)("input",{name:e,placeholder:e.charAt(0).toUpperCase()+e.slice(1),value:t[e],onChange:g,className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold"},e)),(0,o.jsx)(l(),{name:"cpf",placeholder:"CPF",value:t.cpf,onChange:g,className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",options:{blocks:[3,3,3,2],delimiters:[".",".","-"],numericOnly:!0}}),(0,o.jsx)(l(),{name:"telefone",placeholder:"Telefone",value:t.telefone,onChange:g,className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",options:{blocks:[0,2,5,4],delimiters:["(",") ","-",""],numericOnly:!0}}),(0,o.jsx)("button",{type:"submit",className:"w-full bg-white text-[#006400] font-bold py-4 rounded-full hover:bg-emerald-100 transition shadow-lg",children:"Salvar altera\xe7\xf5es"})]})]})]})},["funcionario_administrador"])}},function(e){e.O(0,[332,767,888,774,179],function(){return e(e.s=2186)}),_N_E=e.O()}]);