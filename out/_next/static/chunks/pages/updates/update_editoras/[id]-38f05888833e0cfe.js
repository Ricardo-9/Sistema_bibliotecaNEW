(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61],{3233:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/updates/update_editoras/[id]",function(){return n(8303)}])},1089:function(e,t,n){"use strict";n.d(t,{t:function(){return i}});var o=n(5893),r=n(7294),a=n(1163),s=n(6816);function i(e,t){return function(n){let i=(0,a.useRouter)(),[l,u]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(async()=>{var e;let{data:{user:n},error:o}=await s.O.auth.getUser();if(o||!n){i.push("/login");return}let r=null===(e=n.user_metadata)||void 0===e?void 0:e.role;if(!r||!t.includes(r)){i.push("/unauthorized");return}u(r),c(!1)})()},[i,t]),d)?(0,o.jsx)("p",{children:"Carregando..."}):l?(0,o.jsx)(e,{...n,role:l}):null}}},8303:function(e,t,n){"use strict";n.r(t);var o=n(5893),r=n(7294),a=n(9332),s=n(6816),i=n(1089),l=n(2034),u=n.n(l),d=n(2761),c=n(9673);t.default=(0,i.t)(function(){let{id:e}=(0,a.useParams)(),t=(0,a.useRouter)(),[n,i]=(0,r.useState)({nome:"",email:"",telefone:""}),[l,m]=(0,r.useState)(""),[f,h]=(0,r.useState)("");function p(e){return e.trim().toLowerCase().replace(/\s+/g," ")}function x(e){i({...n,[e.target.name]:e.target.value})}(0,r.useEffect)(()=>{(async()=>{let{data:t,error:n}=await s.O.from("editoras").select("*").eq("id",e).single();if(n){m("Erro ao buscar editora.");return}t&&i({nome:t.nome,email:t.email,telefone:t.telefone})})()},[e]);let g=async o=>{o.preventDefault(),m(""),h("");let r=p(n.nome),a=n.email.trim().toLowerCase(),i=n.telefone.replace(/\D/g,"");if(!/^\S+@\S+\.\S+$/.test(a)){m("Email inv\xe1lido.");return}if(!/^\d{10,11}$/.test(i)){m("O telefone deve conter 10 ou 11 d\xedgitos num\xe9ricos.");return}let{data:l,error:u}=await s.O.from("editoras").select("id, nome, email").neq("id",e);if(u){m("Erro ao verificar duplicidade.");return}let d=null==l?void 0:l.some(e=>p(e.nome)===r),c=null==l?void 0:l.some(e=>e.email.trim().toLowerCase()===a);if(d){m("J\xe1 existe uma editora com esse nome.");return}if(c){m("J\xe1 existe uma editora com esse email.");return}let{error:f}=await s.O.from("editoras").update({nome:n.nome.trim(),email:a,telefone:i}).eq("id",e);f?m("Erro ao atualizar."):(h("Editora atualizada com sucesso!"),setTimeout(()=>t.push("/pesq_editoras"),2e3))};return(0,o.jsxs)("div",{className:"relative flex flex-col items-center justify-center min-h-screen bg-[#006400] px-4 sm:px-8",children:[(0,o.jsx)("button",{onClick:()=>t.push("/pesq_editoras"),className:"absolute top-4 right-4 bg-white text-[#006400] rounded-full p-2 shadow-md hover:bg-emerald-100 transition",children:(0,o.jsx)(d.Z,{className:"w-6 h-6"})}),(0,o.jsxs)("div",{className:"relative z-10 bg-[#2e8b57] rounded-[30px] p-8 sm:p-12 max-w-xl w-full shadow-2xl",children:[(0,o.jsxs)("h1",{className:"text-3xl sm:text-4xl font-bold text-white text-center mb-8 flex items-center justify-center gap-3 drop-shadow",children:[(0,o.jsx)(c.Z,{className:"w-8 h-8"})," Editar Editora"]}),l&&(0,o.jsx)("p",{className:"text-red-400 text-center mb-4",children:l}),f&&(0,o.jsx)("p",{className:"text-green-400 text-center mb-4",children:f}),(0,o.jsxs)("form",{onSubmit:g,className:"space-y-5",children:[(0,o.jsx)("input",{name:"nome",placeholder:"Nome",value:n.nome,onChange:x,className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold"}),(0,o.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:n.email,onChange:x,className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold"}),(0,o.jsx)(u(),{name:"telefone",placeholder:"Telefone",value:n.telefone,onChange:x,className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",options:{blocks:[0,2,5,4],delimiters:["(",") ","-",""],numericOnly:!0}}),(0,o.jsx)("button",{type:"submit",className:"w-full bg-white text-[#006400] font-bold py-4 rounded-full hover:bg-emerald-100 transition shadow-lg",children:"Salvar altera\xe7\xf5es"})]})]})]})},["funcionario","funcionario_administrador"])}},function(e){e.O(0,[332,767,888,774,179],function(){return e(e.s=3233)}),_N_E=e.O()}]);