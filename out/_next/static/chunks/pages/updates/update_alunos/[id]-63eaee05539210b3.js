(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[756],{4586:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/updates/update_alunos/[id]",function(){return r(2443)}])},1089:function(e,t,r){"use strict";r.d(t,{t:function(){return s}});var n=r(5893),a=r(7294),o=r(1163),l=r(6816);function s(e,t){return function(r){let s=(0,o.useRouter)(),[i,u]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{(async()=>{var e;let{data:{user:r},error:n}=await l.O.auth.getUser();if(n||!r){s.push("/login");return}let a=null===(e=r.user_metadata)||void 0===e?void 0:e.role;if(!a||!t.includes(a)){s.push("/unauthorized");return}u(a),d(!1)})()},[s,t]),c)?(0,n.jsx)("p",{children:"Carregando..."}):i?(0,n.jsx)(e,{...r,role:i}):null}}},1664:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(1134).Z)("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},2443:function(e,t,r){"use strict";r.r(t);var n=r(5893),a=r(1089),o=r(7294),l=r(9332),s=r(6816),i=r(2761),u=r(1664),c=r(2034),d=r.n(c);t.default=(0,a.t)(function(){let{id:e}=(0,l.useParams)(),t=(0,l.useRouter)(),[r,a]=(0,o.useState)({nome:"",cpf:"",matricula:"",endereco:"",email:"",telefone:"",serie:"",curso:""}),[c,m]=(0,o.useState)(""),[f,p]=(0,o.useState)("");function h(e){return e.replace(/\D/g,"")}function x(e){a({...r,[e.target.name]:e.target.value})}(0,o.useEffect)(()=>{(async()=>{let{data:t,error:r}=await s.O.from("alunos").select("*").eq("id",e).single();if(r){m("Erro ao buscar aluno.");return}t&&a({nome:t.nome,cpf:t.cpf,matricula:t.matricula,endereco:t.endereco,email:t.email,telefone:t.telefone,serie:t.serie,curso:t.curso})})()},[e]);let g=async n=>{n.preventDefault(),m(""),p("");let a=h(r.cpf).trim(),o=h(r.telefone).trim(),l=r.matricula.trim(),i=r.nome.trim().toLowerCase().replace(/\s+/g," ");if(!/^\d{7}$/.test(l)){m("A matr\xedcula deve conter exatamente 7 d\xedgitos num\xe9ricos.");return}let{data:u,error:c}=await s.O.from("alunos").select("*").eq("cpf",a).neq("id",e);if(c){m("Erro ao verificar duplicidade do CPF.");return}if(u&&u.length>0){m("J\xe1 existe um aluno com esse CPF.");return}let{data:d,error:f}=await s.O.from("alunos").select("*").eq("matricula",l).neq("id",e);if(f){m("Erro ao verificar duplicidade da matr\xedcula.");return}if(d&&d.length>0){m("J\xe1 existe um aluno com essa Matr\xedcula.");return}let{data:x,error:g}=await s.O.from("alunos").select("id, nome").neq("id",e);if(g){m("Erro ao verificar duplicidade do nome.");return}if(null==x?void 0:x.some(e=>e.nome.trim().toLowerCase().replace(/\s+/g," ")===i)){m("J\xe1 existe um aluno com esse nome.");return}let{error:w}=await s.O.from("alunos").update({nome:r.nome.trim(),cpf:a,matricula:l,endereco:r.endereco.trim(),email:r.email.trim(),telefone:o,serie:r.serie.trim(),curso:r.curso.trim()}).eq("id",e);w?m("Erro ao atualizar."):(p("Aluno atualizado com sucesso!"),setTimeout(()=>t.push("/pesq_alunos"),2e3))};return(0,n.jsxs)("div",{className:"relative flex flex-col items-center justify-center min-h-screen bg-[#006400] px-4 sm:px-8",children:[(0,n.jsx)("button",{onClick:()=>t.push("/pesq_alunos"),className:"absolute top-4 right-4 bg-white text-[#006400] rounded-full p-2 shadow-md hover:bg-emerald-100 transition",children:(0,n.jsx)(i.Z,{className:"w-6 h-6"})}),(0,n.jsxs)("div",{className:"relative z-10 bg-[#2e8b57] rounded-[30px] p-8 sm:p-12 max-w-xl w-full shadow-2xl",children:[(0,n.jsxs)("h1",{className:"text-3xl sm:text-4xl font-bold text-white text-center mb-8 flex items-center justify-center gap-3 drop-shadow",children:[(0,n.jsx)(u.Z,{className:"w-8 h-8"})," Editar Aluno"]}),c&&(0,n.jsx)("p",{className:"text-red-400 text-center mb-4",children:c}),f&&(0,n.jsx)("p",{className:"text-green-400 text-center mb-4",children:f}),(0,n.jsxs)("form",{onSubmit:g,className:"space-y-5",children:[[{name:"nome",placeholder:"Nome"},{name:"matricula",placeholder:"Matr\xedcula (7 d\xedgitos)"},{name:"endereco",placeholder:"Endere\xe7o"},{name:"email",placeholder:"Email",type:"email"},{name:"serie",placeholder:"S\xe9rie"},{name:"curso",placeholder:"Curso"}].map(e=>{let{name:t,placeholder:a,type:o}=e;return(0,n.jsx)("input",{name:t,type:o||"text",placeholder:a,value:r[t],onChange:x,className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold"},t)}),(0,n.jsx)(d(),{name:"cpf",placeholder:"CPF",value:r.cpf,onChange:x,className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",options:{blocks:[3,3,3,2],delimiters:[".",".","-"],numericOnly:!0}}),(0,n.jsx)(d(),{name:"telefone",placeholder:"Telefone",value:r.telefone,onChange:x,className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",options:{blocks:[0,2,5,4],delimiters:["(",") ","-",""],numericOnly:!0}}),(0,n.jsx)("button",{type:"submit",className:"w-full bg-white text-[#006400] font-bold py-4 rounded-full hover:bg-emerald-100 transition shadow-lg",children:"Salvar altera\xe7\xf5es"})]})]})]})},["funcionario_administrador"])}},function(e){e.O(0,[332,767,888,774,179],function(){return e(e.s=4586)}),_N_E=e.O()}]);