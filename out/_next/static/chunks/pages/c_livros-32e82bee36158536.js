(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[544],{9075:function(e,n,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/c_livros",function(){return o(6263)}])},1089:function(e,n,o){"use strict";o.d(n,{t:function(){return s}});var t=o(5893),r=o(7294),a=o(1163),i=o(6816);function s(e,n){return function(o){let s=(0,a.useRouter)(),[l,u]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(async()=>{var e;let{data:{user:o},error:t}=await i.O.auth.getUser();if(t||!o){s.push("/login");return}let r=null===(e=o.user_metadata)||void 0===e?void 0:e.role;if(!r||!n.includes(r)){s.push("/unauthorized");return}u(r),c(!1)})()},[s,n]),d)?(0,t.jsx)("p",{children:"Carregando..."}):l?(0,t.jsx)(e,{...o,role:l}):null}}},6263:function(e,n,o){"use strict";o.r(n);var t=o(5893),r=o(9332),a=o(7294),i=o(6816),s=o(2034),l=o.n(s),u=o(2761),d=o(3543),c=o(1089);n.default=(0,c.t)(function(){let e=(0,r.useRouter)(),[n,o]=(0,a.useState)({nome:"",ano_publicacao:"",categoria:"",isbn:"",autor:"",q_disponivel:"",editora:""}),[s,c]=(0,a.useState)(""),[f,m]=(0,a.useState)("");function p(e){let{name:n,value:t}=e.target;o(e=>({...e,[n]:t})),m(""),c("")}async function g(e){e.preventDefault(),m(""),c("");let{data:t,error:r}=await i.O.from("livros").select("isbn").eq("isbn",n.isbn);if(r){m("Erro ao verificar ISBN existente: "+r.message);return}if(t.length>0){m("J\xe1 existe um livro com esse ISBN cadastrado.");return}if(13!==n.isbn.replace(/[^0-9]/g,"").length){m("O campo ISBN deve estar completamente preenchido.");return}let a=parseInt(n.ano_publicacao,10),s=new Date().getFullYear();if(isNaN(a)||a<1e3||a>s){m("Ano de publica\xe7\xe3o inv\xe1lido. Digite um ano entre 1000 e ".concat(s,"."));return}let l=parseInt(n.q_disponivel,10);if(isNaN(l)||l<0){m("Quantidade deve ser um n\xfamero inteiro n\xe3o negativo.");return}let{data:u,error:d}=await i.O.from("editoras").select("nome").eq("nome",n.editora.trim()).limit(1);if(d){m("Erro ao verificar editora: "+d.message);return}if(!u||0===u.length){m("Editora n\xe3o cadastrada.");return}let{error:f}=await i.O.from("livros").insert([{nome:n.nome.trim(),ano_publicacao:n.ano_publicacao.trim(),categoria:n.categoria.trim(),isbn:n.isbn.trim(),autor:n.autor.trim(),q_disponivel:l,editora:n.editora.trim()}]);f?m("Erro ao cadastrar livro: "+f.message):(c("Livro cadastrado com sucesso!"),o({nome:"",ano_publicacao:"",categoria:"",isbn:"",autor:"",q_disponivel:"",editora:""}))}return(0,t.jsxs)("div",{className:"relative flex flex-col items-center justify-center min-h-screen bg-[#006400] px-4 sm:px-8",children:[(0,t.jsx)("div",{className:"absolute top-4 right-4 flex gap-4 z-20",children:(0,t.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"bg-white text-[#006400] rounded-full p-2 shadow-md hover:bg-emerald-100 transition","aria-label":"Voltar",children:(0,t.jsx)(u.Z,{className:"w-6 h-6"})})}),(0,t.jsxs)("div",{className:"relative z-10 bg-[#2e8b57] rounded-[30px] p-8 sm:p-12 max-w-xl w-full shadow-2xl",children:[(0,t.jsxs)("h1",{className:"text-3xl sm:text-4xl font-bold text-white text-center mb-8 flex items-center justify-center gap-3 drop-shadow",children:[(0,t.jsx)(d.Z,{className:"w-8 h-8"})," Cadastro de Livros"]}),f&&(0,t.jsx)("p",{className:"text-red-400 text-center mb-4",children:f}),s&&(0,t.jsx)("p",{className:"text-green-400 text-center mb-4",children:s}),(0,t.jsxs)("form",{onSubmit:g,className:"space-y-6",children:[(0,t.jsx)("input",{className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",type:"text",name:"nome",placeholder:"Nome do livro",required:!0,value:n.nome,onChange:p,autoComplete:"off"}),(0,t.jsx)("input",{className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",type:"number",min:1e3,max:new Date().getFullYear(),name:"ano_publicacao",placeholder:"Ano da publica\xe7\xe3o",required:!0,value:n.ano_publicacao,onChange:p,autoComplete:"off"}),(0,t.jsx)("input",{className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",type:"text",name:"categoria",placeholder:"Categoria do livro",required:!0,value:n.categoria,onChange:p,autoComplete:"off"}),(0,t.jsx)(l(),{className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",name:"isbn",placeholder:"000-0-00-000000-0",value:n.isbn,onChange:function(e){o(n=>({...n,isbn:e.target.value})),m(""),c("")},options:{delimiters:["-","-","-","-"],blocks:[3,1,2,6,1],numericOnly:!0},required:!0}),(0,t.jsx)("input",{className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",type:"text",name:"autor",placeholder:"Nome do autor",required:!0,value:n.autor,onChange:p,autoComplete:"off"}),(0,t.jsx)("input",{className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",type:"number",min:0,name:"q_disponivel",placeholder:"Quantidade dispon\xedvel",required:!0,value:n.q_disponivel,onChange:p,autoComplete:"off"}),(0,t.jsx)("input",{className:"w-full p-4 rounded-full border-none shadow-inner focus:outline-none focus:ring-4 focus:ring-green-700 text-green-900 font-semibold",type:"text",name:"editora",placeholder:"Nome da editora",required:!0,value:n.editora,onChange:p,autoComplete:"off"}),(0,t.jsx)("button",{type:"submit",className:"w-full bg-white text-[#006400] font-bold py-4 rounded-full hover:bg-emerald-100 transition shadow-lg",children:"Cadastrar"})]})]})]})},["funcionario","funcionario_administrador"])}},function(e){e.O(0,[332,767,888,774,179],function(){return e(e.s=9075)}),_N_E=e.O()}]);