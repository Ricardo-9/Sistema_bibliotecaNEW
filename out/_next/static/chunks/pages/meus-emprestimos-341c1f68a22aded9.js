(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[394],{4598:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/meus-emprestimos",function(){return s(3099)}])},1089:function(e,t,s){"use strict";s.d(t,{t:function(){return r}});var n=s(5893),a=s(7294),i=s(1163),o=s(6816);function r(e,t){return function(s){let r=(0,i.useRouter)(),[l,u]=(0,a.useState)(null),[d,c]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{(async()=>{var e;let{data:{user:s},error:n}=await o.O.auth.getUser();if(n||!s){r.push("/login");return}let a=null===(e=s.user_metadata)||void 0===e?void 0:e.role;if(!a||!t.includes(a)){r.push("/unauthorized");return}u(a),c(!1)})()},[r,t]),d)?(0,n.jsx)("p",{children:"Carregando..."}):l?(0,n.jsx)(e,{...s,role:l}):null}}},2761:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(1134).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3099:function(e,t,s){"use strict";s.r(t);var n=s(5893),a=s(7294),i=s(9332),o=s(6816),r=s(1089),l=s(2761),u=s(2089);t.default=(0,r.t)(function(){let e=(0,i.useRouter)(),[t,s]=(0,a.useState)([]),[r,d]=(0,a.useState)(!0),[c,m]=(0,a.useState)(null);return(0,a.useEffect)(()=>{(async function(){let{data:{user:t},error:n}=await o.O.auth.getUser();if(n||!t){m("Erro na autentica\xe7\xe3o."),e.push("/login");return}let{data:a}=await o.O.from("alunos").select("id").eq("user_id",t.id).maybeSingle(),i=null==a?void 0:a.id,r="aluno";if(!i){let{data:e}=await o.O.from("funcionarios").select("id").eq("user_id",t.id).maybeSingle();if(e)i=e.id,r="funcionario";else{m("Usu\xe1rio n\xe3o encontrado."),d(!1);return}}let{data:l,error:u}=await o.O.from("emprestimos").select("id, data_devolucao, livros (nome)").eq("solicitante_id",i).eq("tipo_solicitante",r).is("devolvido",null).order("data_devolucao",{ascending:!0});u?m("Erro ao buscar empr\xe9stimos."):s(l||[]),d(!1)})()},[e]),(0,n.jsxs)("div",{className:"min-h-screen bg-[#006400] flex flex-col items-center justify-start px-4 py-10 relative",children:[(0,n.jsx)("button",{onClick:()=>e.push("/perfil"),className:"absolute top-4 right-4 bg-white text-[#006400] rounded-full p-2 shadow-md hover:bg-emerald-100 transition",children:(0,n.jsx)(l.Z,{className:"w-6 h-6"})}),(0,n.jsxs)("div",{className:"w-full max-w-6xl bg-[#2e8b57] rounded-[30px] p-8 shadow-2xl z-10 text-white",children:[(0,n.jsxs)("h1",{className:"text-4xl font-bold text-center mb-8 flex items-center justify-center gap-2 drop-shadow",children:[(0,n.jsx)(u.Z,{className:"w-8 h-8"})," Meus Empr\xe9stimos"]}),r?(0,n.jsx)("p",{className:"text-center text-lg font-semibold",children:"Carregando..."}):c?(0,n.jsx)("p",{className:"text-center text-red-400 font-semibold",children:c}):0===t.length?(0,n.jsx)("p",{className:"text-center text-lg font-semibold",children:"Voc\xea n\xe3o possui empr\xe9stimos ativos."}):(0,n.jsx)("div",{className:"grid gap-6",children:t.map(e=>(0,n.jsxs)("div",{className:"bg-[#004d00] rounded-2xl p-6 shadow-md text-white flex flex-col gap-2",children:[(0,n.jsxs)("p",{className:"text-lg font-semibold",children:[(0,n.jsx)("strong",{children:"Livro(s):"})," ",e.livros.length>0?e.livros.map(e=>e.nome).join(", "):"Nome n\xe3o encontrado"]}),(0,n.jsxs)("p",{className:"text-lg font-semibold",children:[(0,n.jsx)("strong",{children:"Data para Devolu\xe7\xe3o:"})," ",new Date(e.data_devolucao).toLocaleDateString("pt-BR")]})]},e.id))})]})]})},["aluno","funcionario","funcionario_administrador"])}},function(e){e.O(0,[332,888,774,179],function(){return e(e.s=4598)}),_N_E=e.O()}]);